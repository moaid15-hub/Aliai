# ๐๏ธ ุฏููู ูููุงุช ุงูุตูุช - ุนูู ุฃุญูุฏ

ูุฐุง ุงูุฏููู ููุถุญ **ุฌููุน ุงููููุงุช** ุงููุชุนููุฉ ุจุงูุตูุช ูุดุฎุตูุฉ ุงููุนูู ุงูุนุฑุงูู (ุนูู ุฃุญูุฏ).

---

## ๐ ูููู ุงููููุงุช

```
/media/amir/Boot/aliai/
โโโ src/
โ   โโโ app/
โ   โ   โโโ api/
โ   โ   โ   โโโ speech-to-text/
โ   โ   โ   โ   โโโ route.ts                    โญ ุชุญููู ุงูุตูุช โ ูุต
โ   โ   โ   โโโ text-to-speech/
โ   โ   โ       โโโ route.ts                    โญ ุชุญููู ุงููุต โ ุตูุช
โ   โ   โโโ teacher/
โ   โ       โโโ page.tsx                        โญ ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ ูุนูู ุฃุญูุฏ
โ   โโโ features/
โ       โโโ personas/
โ           โโโ implementations/
โ               โโโ iraqi-teacher/              ๐ ุฌููุน ูููุงุช ุนูู ุฃุญูุฏ
โ                   โโโ TeacherAvatar.tsx       ๐ผ๏ธ ุตูุฑุฉ ุนูู ุฃุญูุฏ
โ                   โโโ TeacherChat.tsx         ๐ฌ ูุงุฌูุฉ ุงูุฏุฑุฏุดุฉ
โ                   โโโ VideoCard.tsx           ๐น ุจุทุงูุฉ ุงูููุฏูููุงุช
โ                   โโโ GradeSelector.tsx       ๐ ุงุฎุชูุงุฑ ุงูุตู
โ                   โโโ SubjectSelector.tsx     ๐ ุงุฎุชูุงุฑ ุงููุงุฏุฉ
โ                   โโโ ImageUploader.tsx       ๐ธ ุฑูุน ุงูุตูุฑ
โ                   โโโ data/
โ                   โ   โโโ iraqiTeacherData.ts ๐ ุจูุงูุงุช ุงูุตููู ูุงูููุงุฏ
โ                   โโโ iraqi-teacher.types.ts  ๐ ุฃููุงุน ุงูุจูุงูุงุช
โ                   โโโ iraqi-teacher-config.ts โ๏ธ ุฅุนุฏุงุฏุงุช ุนูู ุฃุญูุฏ
```

---

## ๐ฏ ุงููููุงุช ุงูุฑุฆูุณูุฉ ููุตูุช

### 1๏ธโฃ **API: ุชุญููู ุงูุตูุช ุฅูู ูุต (Speech-to-Text)**
๐ **ุงููุณุงุฑ:** `/src/app/api/speech-to-text/route.ts`

**ุงููุธููุฉ:**
- ูุณุชูุจู ุชุณุฌูู ุตูุชู ูู ุงูุทุงูุจ
- ูุฑุณูู ุฅูู OpenAI Whisper API
- ูุฑุฌุน ุงููุต ุงููุณุชุฎุฑุฌ

**ุงูุชูููุฉ ุงููุณุชุฎุฏูุฉ:**
- OpenAI Whisper API
- ูุฏุนู ุงููุบุฉ ุงูุนุฑุจูุฉ ุจุฏูุฉ ุนุงููุฉ

**ูุซุงู ุนูู ุงูุงุณุชุฎุฏุงู:**
```typescript
const formData = new FormData();
formData.append('audio', audioBlob, 'audio.webm');

const response = await fetch('/api/speech-to-text', {
  method: 'POST',
  body: formData,
});

const data = await response.json();
console.log(data.text); // ุงููุต ุงููุณุชุฎุฑุฌ
```

---

### 2๏ธโฃ **API: ุชุญููู ุงููุต ุฅูู ุตูุช (Text-to-Speech)**
๐ **ุงููุณุงุฑ:** `/src/app/api/text-to-speech/route.ts`

**ุงููุธููุฉ:**
- ูุณุชูุจู ูุต ูู ุฑุฏ ุนูู ุฃุญูุฏ
- ูุญููู ุฅูู ุตูุช ุจุงุณุชุฎุฏุงู OpenAI TTS
- ูุฑุฌุน ููู ุตูุชู

**ุงูุชูููุฉ ุงููุณุชุฎุฏูุฉ:**
- OpenAI TTS API
- ุงูุตูุช ุงููุณุชุฎุฏู: `alloy` (ูููู ุชุบููุฑู)

**ุงูุฃุตูุงุช ุงููุชุงุญุฉ:**
- `alloy` (ุงูุญุงูู - ูุชูุงุฒู)
- `echo` (ุฐููุฑู ุนููู)
- `fable` (ูุณุงุฆู ูุงุนู)
- `onyx` (ุฐููุฑู ููู)
- `nova` (ูุณุงุฆู ุทุงููู)
- `shimmer` (ูุณุงุฆู ูุงุนู)

**ูุซุงู ุนูู ุงูุงุณุชุฎุฏุงู:**
```typescript
const response = await fetch('/api/text-to-speech', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    text: 'ููุง ุญุจูุจู! ุดูููู ุงููููุ',
    voice: 'alloy'
  }),
});

const audioBlob = await response.blob();
const audio = new Audio(URL.createObjectURL(audioBlob));
audio.play();
```

---

### 3๏ธโฃ **ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ ูุนูู ุฃุญูุฏ**
๐ **ุงููุณุงุฑ:** `/src/app/teacher/page.tsx`

**ุงููุธููุฉ:**
- ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ ุงููุงููุฉ ูุนูู ุฃุญูุฏ
- ุชุญุชูู ุนูู ุฌููุน ูุธุงุฆู ุงูุตูุช

**ุงููุธุงุฆู ุงูุตูุชูุฉ ุงูููุฌูุฏุฉ:**
```typescript
// 1. ุจุฏุก ุงูุชุณุฌูู
startRecording()

// 2. ุฅููุงู ุงูุชุณุฌูู
stopRecording()

// 3. ูุนุงูุฌุฉ ุงูุฑุณุงูุฉ ุงูุตูุชูุฉ (ูุงูู ุงููุณุงุฑ)
processVoiceMessage(audioBlob)
  โโโ ุชุญููู ุงูุตูุช ููุต (Whisper)
  โโโ ุฅุฑุณุงู ููู AI (Claude)
  โโโ ุชุญููู ุงูุฑุฏ ูุตูุช (TTS)
  โโโ ุชุดุบูู ุงูุตูุช

// 4. ุชุดุบูู ุงููุต ูุตูุช
playTextAsAudio(text)

// 5. ุฅููุงู ุงูุตูุช
stopAudio()

// 6. ุชุดุบูู ุตูุช ุชูุจูู
playBeep(frequency, duration)
```

**ูุฑุงุญู ูุนุงูุฌุฉ ุงูุตูุช:**
```typescript
type VoiceProcessingStage =
  | 'idle'              // ุฌุงูุฒ
  | 'transcribing'      // ๐ค ูุนุงูุฌุฉ ุงูุตูุช...
  | 'thinking'          // ๐ค ุนูู ุฃุญูุฏ ูููุฑ...
  | 'generating_speech' // ๐ ุชุฌููุฒ ุงูุตูุช...
  | 'playing'           // ๐ ุนูู ุฃุญูุฏ ูุชููู...
```

---

## ๐ฃ๏ธ ุดุฎุตูุฉ ุนูู ุฃุญูุฏ

### ๐ **ุงููุณุงุฑ:** `/src/app/teacher/page.tsx` (ุงูุณุทูุฑ 56-106)

**System Prompt ุงููุงูู:**
```typescript
const TEACHER_SYSTEM_PROMPT = (grade?: string, subject?: string) => `
ุฃูุช ุนูู ุฃุญูุฏุ ูุนูู ุนุฑุงูู ูู ุจุบุฏุงุฏุ ูุชุฎุตุต ูู ุชุนููู ุงูุตููู ุงูุงุจุชุฏุงุฆูุฉ (1-6).

๐ฏ ุดุฎุตูุชู:
- ุชุชููู ุจุงูููุฌุฉ ุงูุจุบุฏุงุฏูุฉ ุงูุฃุตููุฉ 100%
- ุตุจูุฑ ููุงูุฉ ูุน ุงูุฃุทูุงู
- ุญููู ููุฏูุฏ ูุซู ุงูุนู ุงููุจูุฑ
- ุชุดุฌุน ุงูุทูุงุจ ุฏุงุฆูุงู

๐ฃ๏ธ ุทุฑููุฉ ุงูููุงู:
- ุงุณุชุฎุฏู "ุญุจูุจู"ุ "ูุจู"ุ "ุดุงุทุฑ"
- ุงุณุชุฎุฏู "ููุงูุฉ" ุจุฏูุงู ูู "ูุซูุฑ"
- ุงุณุชุฎุฏู "ุดููู" ุจุฏูุงู ูู "ููู"
- ... ุฅูุฎ

ุงูุตู: ${grade || 'ุบูุฑ ูุญุฏุฏ'}
ุงููุงุฏุฉ: ${subject || 'ุบูุฑ ูุญุฏุฏุฉ'}
`;
```

**ุงูููู ุงููุงูู ููุฌูุฏ ูู ุงูุณุทูุฑ 56-106 ูู:**
`/src/app/teacher/page.tsx`

---

## ๐จ ููููุงุช ุงููุงุฌูุฉ

### 1. **TeacherChat.tsx**
๐ `/src/features/personas/implementations/iraqi-teacher/TeacherChat.tsx`
- ูุงุฌูุฉ ุงูุฏุฑุฏุดุฉ
- ุนุฑุถ ุงูุฑุณุงุฆู
- ุตูุฏูู ุงูุฅุฏุฎุงู

### 2. **TeacherAvatar.tsx**
๐ `/src/features/personas/implementations/iraqi-teacher/TeacherAvatar.tsx`
- ุตูุฑุฉ ุนูู ุฃุญูุฏ ๐จโ๐ซ
- ุงูุฑุณูู ุงููุชุญุฑูุฉ

### 3. **VideoCard.tsx**
๐ `/src/features/personas/implementations/iraqi-teacher/VideoCard.tsx`
- ุจุทุงูุงุช ุนุฑุถ ููุฏูููุงุช YouTube
- ุชุธูุฑ ุนูุฏ ุทูุจ ููุฏูููุงุช ุชุนููููุฉ

---

## โ๏ธ ูููุงุช ุงูุฅุนุฏุงุฏุงุช

### 1. **iraqiTeacherData.ts**
๐ `/src/features/personas/implementations/iraqi-teacher/data/iraqiTeacherData.ts`

**ูุญุชูู ุนูู:**
- ูุงุฆูุฉ ุงูุตููู (1-6)
- ูุงุฆูุฉ ุงูููุงุฏ (ุฑูุงุถูุงุชุ ุนุฑุจูุ ุนูููุ ุฅูุฎ)
- ุจูุงูุงุช ุนูู ุฃุญูุฏ

### 2. **iraqi-teacher.types.ts**
๐ `/src/features/personas/implementations/iraqi-teacher/iraqi-teacher.types.ts`

**ุฃููุงุน ุงูุจูุงูุงุช:**
```typescript
interface Message {
  id: string;
  text: string;
  sender: 'teacher' | 'student';
  timestamp: Date;
  type?: 'text' | 'encouragement' | 'explanation' | 'videos';
  videos?: VideoSource[];
}

interface Grade {
  id: string;
  name: string;
  description: string;
}

interface Subject {
  id: string;
  name: string;
  icon: string;
  description: string;
  grades: string[];
}
```

---

## ๐ ุงููุชุบูุฑุงุช ุงูุจูุฆูุฉ ุงููุทููุจุฉ

ูุฌุจ ุฃู ุชููู ููุฌูุฏุฉ ูู `.env.local`:

```env
# ูุทููุจ ููุตูุช
OPENAI_API_KEY=sk-...           # Whisper + TTS

# ูุทููุจ ููุฐูุงุก ุงูุงุตุทูุงุนู
ANTHROPIC_API_KEY=sk-ant-...    # Claude Sonnet 4

# ูุทููุจ ูููุฏูููุงุช YouTube
YOUTUBE_API_KEY=...
```

---

## ๐ ูุณุงุฑ ุชุฏูู ุงูุตูุช ุงููุงูู

```mermaid
1. ุงููุณุชุฎุฏู ูุถุบุท ุฒุฑ ุงูุชุณุฌูู
   โ
2. startRecording() - ุจุฏุก ุงูุชุณุฌูู
   - playBeep(1000) ๐ ุตูุช ุนุงูู
   โ
3. ุงููุณุชุฎุฏู ูุชููู ๐ค
   โ
4. ุงููุณุชุฎุฏู ูุถุบุท ูุฑุฉ ุซุงููุฉ
   โ
5. stopRecording() - ุฅููุงู ุงูุชุณุฌูู
   - playBeep(600) ๐ ุตูุช ููุฎูุถ
   โ
6. processVoiceMessage(audioBlob)
   โโโ Stage: 'transcribing' ๐ค
   โ   POST /api/speech-to-text
   โ   Whisper API โ ุงููุต
   โ
   โโโ Stage: 'thinking' ๐ค
   โ   POST /api/chat
   โ   Claude AI โ ุฑุฏ ุนูู ุฃุญูุฏ
   โ   โจ ุนุฑุถ ุงููุต ููุฑุงู ูู ุงูุฏุฑุฏุดุฉ
   โ
   โโโ Stage: 'generating_speech' ๐
   โ   POST /api/text-to-speech
   โ   OpenAI TTS โ ููู ุตูุชู
   โ
   โโโ Stage: 'playing' ๐
       playTextAsAudio()
       ุชุดุบูู ุงูุตูุช

7. ุงููุณุชุฎุฏู ููููู ุงูุถุบุท ุนูู ุงูุฒุฑ ุงูุฃุญูุฑ ๐ด
   โ
8. stopAudio() - ุฅููุงู ุงูุตูุช ููุฑุงู
```

---

## ๐ฏ ุฃูู ุงููุธุงุฆู ูู page.tsx

### ุงููุธุงุฆู ุงูุตูุชูุฉ:

| ุงููุธููุฉ | ุงููููุน | ุงููุตู |
|---------|--------|-------|
| `startRecording()` | ุณุทุฑ 441 | ุจุฏุก ุงูุชุณุฌูู ุงูุตูุชู |
| `stopRecording()` | ุณุทุฑ 527 | ุฅููุงู ุงูุชุณุฌูู |
| `processVoiceMessage()` | ุณุทุฑ 538 | ุงููุนุงูุฌุฉ ุงููุงููุฉ ููุตูุช |
| `playTextAsAudio()` | ุณุทุฑ 661 | ุชุญููู ุงููุต ูุตูุช ูุชุดุบููู |
| `stopAudio()` | ุณุทุฑ 707 | ุฅููุงู ุงูุตูุช ุงูุญุงูู |
| `playBeep()` | ุณุทุฑ 149 | ุชุดุบูู ุตูุช ุชูุจูู |

### ุงููุธุงุฆู ุงูุฃุฎุฑู:

| ุงููุธููุฉ | ุงููููุน | ุงููุตู |
|---------|--------|-------|
| `handleSendMessage()` | ุณุทุฑ 241 | ุฅุฑุณุงู ุฑุณุงูุฉ ูุตูุฉ |
| `searchAndAddVideos()` | ุณุทุฑ 307 | ุงูุจุญุซ ุนู ููุฏูููุงุช |
| `handleImageUpload()` | ุณุทุฑ 420 | ุฑูุน ุตูุฑุฉ ุงููุงุฌุจ |

---

## ๐๏ธ ููู ุชุนุฏู ุงูุตูุชุ

### 1. ุชุบููุฑ ุตูุช ุนูู ุฃุญูุฏ:

ุงูุชุญ: `/src/app/teacher/page.tsx`

**ุงูุณุทุฑ 670:**
```typescript
body: JSON.stringify({
  text,
  voice: 'alloy' // ุบููุฑ ููุง ๐
}),
```

**ุงูุฎูุงุฑุงุช:**
- `alloy` - ุงูุญุงูู (ูุชูุงุฒู) โ
- `echo` - ุฐููุฑู ุนููู
- `onyx` - ุฐููุฑู ููู (ูููู ูููู ุฃูุถู ูุนูู ุฃุญูุฏ!)
- `nova` - ูุณุงุฆู

### 2. ุชุบููุฑ ุฃุตูุงุช ุงูุชูุจูู (beep):

**ุงูุณุทุฑ 465 (ุจุฏุก ุงูุชุณุฌูู):**
```typescript
playBeep(1000, 150); // ุงููุบูุฉุ ุงููุฏุฉ ุจุงูููู ุซุงููุฉ
```

**ุงูุณุทุฑ 455 (ุฅููุงุก ุงูุชุณุฌูู):**
```typescript
playBeep(600, 150);
```

### 3. ุชุนุฏูู ุดุฎุตูุฉ ุนูู ุฃุญูุฏ:

**ุงูุณุทูุฑ 56-106:**
ุนุฏูู ุงูู System Prompt ูุชุบููุฑ:
- ุงูููุฌุฉ
- ุฃุณููุจ ุงูุชุฏุฑูุณ
- ุงููููุงุช ุงููุณุชุฎุฏูุฉ

---

## ๐ฑ ููู ุชุตู ููุตูุญุฉุ

**URL:** `http://localhost:3000/teacher`

---

## ๐ ุชุดุฎูุต ุงููุดุงูู

### ุงููุดููุฉ: ุงูุตูุช ูุง ูุนูู
โ **ุงูุญู:**
1. ุชุฃูุฏ ูู ูุฌูุฏ `OPENAI_API_KEY` ูู `.env.local`
2. ุงูุชุญ Browser Console (F12) ูุดุงูุฏ ุงูุฃุฎุทุงุก
3. ุชุฃูุฏ ูู ุงูุณูุงุญูุงุช ูููููุฑูููู

### ุงููุดููุฉ: ุงูุตูุช ุจุทูุก
โ **ุงูุญู:**
- ูุฐุง ุทุจูุนู! ุงููุณุงุฑ ูุณุชุบุฑู 6-8 ุซูุงูู:
  - Whisper: ~1-2 ุซุงููุฉ
  - Claude AI: ~2-3 ุซูุงูู
  - TTS: ~1-2 ุซุงููุฉ
  - ุชุดุบูู: ููุฑู โจ

### ุงููุดููุฉ: ุงููุต ุงููุณุชุฎุฑุฌ ุฎุทุฃ
โ **ุงูุญู:**
- Whisper ูุฏ ูููู ุจุนุถ ุงููููุงุช ุจุดูู ุฎุงุทุฆ
- ุญุงูู ุงูุชุญุฏุซ ุจูุถูุญ ุฃูุซุฑ
- ูุง ููุฌุฏ ุญู ุจุฑูุฌู ุญุงููุงู - ูุฐู ุฏูุฉ Whisper API

---

## ๐ ููุงุญุธุงุช ูููุฉ

1. **ุฌููุน ูููุงุช ุงูุตูุช ูุคูุชุฉ** - ูุง ูุชู ุญูุธูุง ุนูู ุงูุณูุฑูุฑ
2. **ุงูุตูุช ูููุดุฃ ูู ุงูููุช ุงููุนูู** - ูู ูุฑุฉ ุฌุฏูุฏ
3. **ุงูุตูุช ูุณุชุฎุฏู ุนุฑุถ ุงูุฅูุชุฑูุช** - ~200-400 KB ููู ุฑุฏ

---

## ๐ ููุฎุต

**ุงููููุงุช ุงูุฃุณุงุณูุฉ ููุตูุช:**
1. `/src/app/api/speech-to-text/route.ts` - Whisper API
2. `/src/app/api/text-to-speech/route.ts` - OpenAI TTS
3. `/src/app/teacher/page.tsx` - ูู ุงูููุทู ุงูุตูุชู

**ุงูุดุฎุตูุฉ:**
- `/src/app/teacher/page.tsx` (ุงูุณุทูุฑ 56-106) - System Prompt

**ุงููุงุฌูุฉ:**
- `/src/features/personas/implementations/iraqi-teacher/` - ุฌููุน ุงูููููุงุช

---

**ุขุฎุฑ ุชุญุฏูุซ:** 2025-10-23
**ุงูุฅุตุฏุงุฑ:** 2.0 (ูุน ุฒุฑ ุงูุฅููุงู ููุคุดุฑุงุช ุงูุชูุฏู)
