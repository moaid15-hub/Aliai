# عقول (Oqool AI) - نظام الذكاء الاصطناعي متعدد المزودات

## 🌟 المميزات الجديدة

### دعم متعدد المزودات للذكاء الاصطناعي
يدعم المشروع الآن عدة مزودات للذكاء الاصطناعي مع نظام احتياطي ذكي:

#### 1. **Claude AI (Anthropic)**
- المزود الأساسي للذكاء الاصطناعي
- يتميز بفهم عميق للغة العربية
- استجابات دقيقة ومفيدة

#### 2. **OpenAI GPT-4**
- البديل الثاني للذكاء الاصطناعي
- تقنيات متقدمة في معالجة النصوص
- دعم ممتاز للحوارات التفاعلية

#### 3. **النظام المحلي**
- نظام احتياطي عندما تفشل APIs الخارجية
- ردود محددة مسبقاً باللغة العربية
- يعمل دون الحاجة لإنترنت

## ⚙️ إعداد المزودات

### 1. إعداد متغيرات البيئة

أنشئ ملف `.env.local` في جذر المشروع:

```bash
# Claude AI من Anthropic
ANTHROPIC_API_KEY=sk-ant-your-key-here

# OpenAI GPT
OPENAI_API_KEY=sk-your-openai-key-here

# المزود المفضل (claude, openai, auto)
PREFERRED_AI_PROVIDER=claude
```

### 2. الحصول على مفاتيح API

#### مفتاح Claude AI:
1. اذهب إلى [console.anthropic.com](https://console.anthropic.com/)
2. أنشئ حساب جديد
3. اذهب إلى API Keys
4. أنشئ مفتاح جديد وانسخه

#### مفتاح OpenAI:
1. اذهب إلى [platform.openai.com](https://platform.openai.com/api-keys)
2. سجل الدخول أو أنشئ حساب
3. أنشئ API Key جديد
4. انسخ المفتاح

## 🔄 كيف يعمل النظام

### نظام الاختيار الذكي

1. **الوضع التلقائي (auto)**: 
   - يختار المزود الأفضل تلقائياً
   - يحاول Claude أولاً، ثم OpenAI، ثم المحلي

2. **تحديد المزود**:
   - يمكن للمستخدم اختيار مزود محدد
   - القائمة المنسدلة في أعلى الشاشة

3. **النظام الاحتياطي**:
   - إذا فشل المزود المختار، ينتقل للبديل
   - إذا فشلت جميع APIs، يستخدم النظام المحلي

### مؤشرات المزود

في أعلى الشاشة ستشاهد:
- 🤖 **Claude AI** - عندما يستخدم Anthropic
- 🧠 **OpenAI** - عندما يستخدم GPT-4
- 💻 **محلي** - عندما يستخدم النظام المحلي

## 📝 استخدام المزودات

### في الكود:

```typescript
// إرسال رسالة مع تحديد المزود
const response = await fetch('/api/chat', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ 
    messages: [...],
    provider: 'claude' // أو 'openai' أو 'auto'
  })
});
```

### تدفق البيانات:

```
المستخدم يرسل رسالة
        ↓
يختار النظام المزود المناسب
        ↓
يحاول الاتصال بـ API المحدد
        ↓
إذا فشل → يجرب المزود البديل
        ↓
إذا فشلت جميع APIs → النظام المحلي
        ↓
إرجاع الاستجابة للمستخدم
```

## 🛠️ استكشاف الأخطاء

### مشاكل شائعة:

1. **"API Key غير صحيح"**:
   - تأكد من صحة مفاتيح API في `.env.local`
   - تأكد من عدم انتهاء صلاحية المفاتيح

2. **"فشل في جميع APIs"**:
   - تحقق من الاتصال بالإنترنت
   - تأكد من وجود رصيد في حسابات API
   - سيعمل النظام المحلي كبديل

3. **"استجابات بطيئة"**:
   - بعض APIs قد تكون بطيئة حسب التحميل
   - النظام سينتقل تلقائياً للبديل الأسرع

### رسائل الخطأ:

```bash
# في console المتصفح
"Claude API فشل، جاري المحاولة مع OpenAI..."
"OpenAI API فشل أيضاً، استخدام النظام المحلي..."
```

## 🚀 التشغيل والتطوير

```bash
# تثبيت الحزم
npm install

# تشغيل المشروع محلياً
npm run dev

# بناء للإنتاج
npm run build
npm start
```

## 📊 مراقبة الأداء

يمكنك مراقبة أداء المزودات من خلال:

1. **شاشة المطور**: تحقق من Network Tab لرؤية استجابة APIs
2. **مؤشر المزود**: في واجهة المستخدم لمعرفة المزود المستخدم
3. **Console Logs**: رسائل مفصلة حول حالة كل مزود

## 🔐 الأمان

- جميع مفاتيح API محفوظة في متغيرات البيئة
- لا يتم إرسال المفاتيح إلى المتصفح
- النظام لا يحفظ المحادثات على الخوادم الخارجية

## 📈 التحسينات المستقبلية

- [ ] إضافة مزودات أخرى (Cohere, PaLM, etc.)
- [ ] نظام cache للاستجابات
- [ ] إحصائيات استخدام المزودات
- [ ] تحسين خوارزمية اختيار المزود
- [ ] دعم streaming للاستجابات الطويلة

---

**ملاحظة**: تأكد من وجود مفاتيح API صحيحة للحصول على أفضل تجربة. بدون مفاتيح، سيعمل النظام في الوضع المحلي المحدود.